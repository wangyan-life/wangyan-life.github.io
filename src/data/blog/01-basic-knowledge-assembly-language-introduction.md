---
title: 01 基础知识 汇编语言入门教程
author: Wang Yan
pubDatetime: 2022-09-29T04:06:31Z
slug: 01-basic-knowledge-assembly-language-introduction
featured: false
draft: false
tags:
  - 汇编语言
description:
  汇编语言是直接在硬件层面工作的编程语言，本文介绍了汇编语言的基本概念、组成部分以及与计算机硬件的交互方式。
---

## 引言

汇编语言是直接在硬件层面工作的编程语言（因此汇编语言是除机器语言外最高效的的语言），首先要了解硬件系统的结构（主要是 CPU 和内存），才能有效地引用汇编语言对其进行编程。

显卡、网卡、CPU、声卡等硬件都有自带的内存。

汇编课程的研究重点在于如何利用硬件系统的编程结构和指令集有效灵活地控制系统进行工作。

## ⒈1 机器语言

机器语言是机器指令的集合。机器指令简单来讲就是一台机器可以正确执行的命令。

早期程序员们将 0、1 数字编程的程序代码打在纸带或卡片上，1 打孔，0 不打孔，再将程序通过纸带机或卡片机输入计算机，进行运算……这就是机器语言的由来。

## ⒈2 汇编语言的产生

若需要在显示器上输出一句话，需要的机器语言代码十分冗长，且极易出错，于是就产生了汇编语言。

汇编语言的主体是汇编指令。越高级的语言，越方便程序的编写，但理论上效率也会越低。

汇编指令和机器指令的差别在于指令的表示方法，汇编指令是机器指令便于记忆的书写格式。汇编指令是机器指令的助记符。

> 例：
> 机器指令：`1000100111011000`
> 汇编指令：`MOV AX,BX`
> 操作：将寄存器 BX 的内容传到 AX 中

这样的写法与人类语言接近，便于阅读、书写和记忆。

寄存器：CPU 中可以储存数据的器件，简单地讲就是嵌入到 CPU 里面的内存，一个 CPU 中可以有多个寄存器。

AX 是其中一个寄存器的代号，BX 是另一个寄存器的代号。

> 问：计算机能读懂的只有机器指令，那么如何让计算机执行程序员用汇编语言编写的程序呢？
> 
> * 用汇编语言编写的程序的工作过程：
> 
> ![用汇编语言编写的程序的工作过程](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0001.webp)

## ⒈3 汇编语言的组成

汇编语言由以下 3 类组成：

1. 汇编指令（机器码的助记符，由编译器转换为机器指令）
2. 伪指令（由编译器执行）
3. 其他符号（由编译器识别）

汇编语言的核心是汇编指令，它决定了汇编语言的特性。

## ⒈4 存储器

CPU 是计算机的核心部件，它控制着整个 CPU 的运作并进行运算，想要一个 CPU 工作，就必须向它提供指令和数据。

指令和数据在存储器中存放，也就是平时所说的内存。在一台PC中内存的作用仅次于 CPU，离开了内存，再好的 CPU 也无法工作。

磁盘不同于内存，磁盘上的数据或程序必须先加载到内存才能被 CPU 使用，CPU 不能直接使用磁盘里的数据。

## ⒈5 指令和数据

指令和数据是应用上的概念，对内存或磁盘来说，指令和数据没有任何区别，都是二进制信息。

> 例：
> `1000100111011000`
> 作为数据，可以看成：`89D8H`
> 作为指令，可以看成：`MOV AX,BX`

## ⒈6 存储单元

存储器被划分为若干个存储单元，每个存储单元都从0开始顺序编号；

> 例：
> 一个存储器有 128 个存储单元，则编号为 0~127。
> 
> 存储单元的编号：
> 
> ![存储单元的编号](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0002.webp)

对于大容量的存储器，一般用以下单位来计量容量（以下用 B 表示 Byte，字节，1 Byte = 8 bit，bit，位，bit可以用 b 表示）：

* 1 KB = 1024 B
* 1 MB = 1024 KB
* 1 GB = 1024 MB
* 1 TB = 1024 GB

> 其中 1024 即为 2^10

磁盘的容量单位同内存的一样，实际上以上单位是微机中常用的计量单位。

## ⒈7 CPU对存储器的读写

CPU 想要进行数据的读写，必须和外部器件（芯片）进行三类信息的交互：

* 存储单元的地址（地址信息）
* 器件的选择、读或写命令（控制信息）
* 读或写的数据内容（数据信息）

> 问：那么 CPU 是通过什么将地址、控制、数据信息传输到存储芯片中的呢？
> 
> * 电子计算机能够传输、处理的信息都是电信号，电信号当然要用导线传输。

在计算机中有专门连接 CPU 和其他芯片的导线，通常称为总线。

* 物理上：一根根导线的集合；
* 逻辑上划分为：地址总线、控制总线、数据总线，分别对应三类信息交互。
  
  CPU 从 3 号存储单元中读取数据的过程如下：

![CPU 从内存读取数据的过程](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0003.webp)

1. CPU 通过地址总线将地址信息 3 发出；
2. CPU 通过控制总线发出内存读命令，选中存储器芯片，并通知它，将要从中读取数据；
3. 存储器将3号单元中的数据 8 通过数据总线送入 CPU。

写操作与读操作的步骤相似，如向 3 号单元写入数据 26：

1. CPU 通过地址总线将地址信息 3 发出；
2. CPU 通过控制总线发出内存写命令，选中存储器芯片，并通知它，要向其中写入数据；
3. CPU 通过数据总线将数据 26 送入内存的 3 号存储单元中。

## ⒈8 地址总线

> 问：从上面我们知道了 CPU 是如何进行数据读写的。可是，如何命令计算机进行数据的读写呢？
> 
> * 要让一个计算机或微处理器工作，应向它输入能够驱动它进行工作的电平信息（机器码）。

对于 8086 CPU，下面的机器码，能够完成从 3 号存储单元读取数据：

> 机器码：`101000000000001100000000`
> 含义：从 3 号存储单元读取数据并送入寄存器 AX

CPU 是通过地址总线来指定存储单元的。地址总线上能传输多少个不同的信息，决定了 CPU 能对多少个存储单元进行寻址。

CPU、系统、软件必须都是 64 位，才能真正地称为 64 位 PC。

地址总线上发送的地址信息：

![地址总线上发送的地址信息](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0004.webp)

一个 CPU 有 N 根地址总线，则可以说这个 CPU 的地址总线的宽度为 N，这样的 CPU 最多可以同时寻找 2^N 个存储单元。64 位（ 64 bit ）即为 8 字节（ 8 Byte ），故 64 位 CPU 的地址总线宽度为 N = 64/8 = 8，最多可以同时寻找 2^8 = 256 个存储单元。

## ⒈9 数据总线

CPU 与内存或其他器件之间的数据传输是通过数据总线来进行的。数据总线的宽度决定了CPU与外部器件的数据传输速度。

8088 CPU 的数据总线宽度为 8，8086 CPU 的数据总线宽度为 16；因此，8088 CPU 分两次传送 `89D8H`，第一次传送 `D8`，第二次传送 `89`；（这里的“H”表示 `89D8` 是一个16进制的数，类似的还有“D”表示十进制，“O”表示八进制，“B”表示二进制）；

8088 CPU 分两次传送 `89D8H`，即 8 位数据总线上传输的信息：

![8 位数据总线上传输的信息](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0005.webp)

而 8086 CPU 一次传送 `89D8H`，即 16 位数据总线上传输的信息：

![16 位数据总线上传输的信息](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0006.webp)
8086 CPU 有 16 根数据总线，可一次传送 16 位数据，所以可一次传送数据 `89D8H`；而 8088 CPU 只有 8 根数据总线，一次只能传 8 位数据，所以向内存写入数据 `89D8H` 时需要进行两次数据传送。

## ⒈10 控制总线

CPU 对外部器件的控制是通过控制总线来进行的。这里的控制总线是一个总称，控制总线是一些不同控制线的集合。有多少根控制总线，就意味着 CPU 提供了对外部器件的多少种控制。因此，控制总线的宽度决定了 CPU 对外部器件的控制能力。

对内存的读或写命令是由几根控制线综合发出的，其中有一根称为“读信号输出”的控制线负责由 CPU 向外传送读信号，CPU 向该控制线上输出低电平表示将要读取数据；有一根称为“写信号输出”的控制线则负责传送写信号。

## ⒈11 内存地址空间概述

什么是内存地址空间呢？举例来讲，一个 CPU 的地址总线宽度为 10，那么可以寻址 2^10 = 1024 个内存单元，这 1024 个可寻到的内存单元就构成这个 CPU 的内存地址空间。下面进行深入讨论，首先需要介绍两部分基本知识：主板和接口卡。

## ⒈12 主板

在每一台 PC 机中，都有一个主板，主板上有核心器件和一些主要器件，这些器件通过总线（地址总线、数据总线、控制总线）相连。这些器件有 CPU、存储器、外围芯片组、扩展插槽等。扩展插槽上一般插有 RAM 内存条和各类接口卡。

## ⒈13 接口卡

计算机系统中，所有可用程序控制其工作的设备，必须受到 CPU 的控制。CPU 对外部设备都不能直接控制，如显示器、音箱、打印机等。直接控制这些设备进行工作的是插在扩展插槽上的接口卡。扩展插槽通过总线和 CPU 相连，所以接口卡也通过总线同 CPU 相连。CPU 可以直接控制这些接口卡，从而实现 CPU 对外设的间接控制。简单地讲，就是 CPU 通过总线向接口卡发送命令，接口卡根据 CPU 的命令控制外部设备进行工作。

## ⒈14 各类存储器芯片

从读写属性上看分为两类：随机存储器（ RAM ）和只读存储器（ ROM ）；

从功能和连接上分类：随机存储器 RAM、装有 BIOS 的 ROM、接口卡上的 RAM；

装有 BIOS 的 ROM：

> BIOS 即为 Basic Input/Output System，基本输入输出系统。

BIOS 是由主板和各类接口卡（如显卡、网卡等）厂商提供的软件系统，可以通过它利用该硬件设备进行最基本的输入输出。在主板和某些接口卡上插有存储相应 BIOS 的 ROM；

PC 系统中各类存储器的逻辑连接情况：

![PC 系统中各类存储器的逻辑连接情况](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0007.webp)

## ⒈15 内存地址空间

上述的那些存储器，在物理上是独立的器件,但是在以下两点上相同：

* 都和 CPU 的总线相连；
* CPU 对它们进行读或写的时候都通过控制总线发出内存读写命令。
  
  将各类存储器看作一个逻辑存储器：

![将各类存储器看作一个逻辑存储器](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0008.webp)

* 所有的物理存储器被看作一个由若干存储单元组成的逻辑存储器；
* 每个物理存储器在这个逻辑存储器中占有一个地址段即一段地址空间；
* CPU 在这段地址空间中读写数据，实际上就是在相对应的物理存储器中读写数据。
  
  不同的计算机系统的内存地址空间的分配情况是不同的。
  
  8086 PC 机内存地址空间分配：

![8086 PC 机内存地址空间分配](https://cloud.wangyan.life/d/wangyan.life/Pictures/1-Notes/0001-0009.webp)

最终运行程序的是 CPU，我们用汇编语言编程的时候，必须要从CPU的角度考虑问颗（核心思维）。
对 CPU 来讲，系统中的所有存储器中的存储单元都处于一个统一的逻辑存储器中，它的容量受 CPU 寻址能力的限制。这个逻辑存储器即是我们所说的内存地址空间。

## ⒈16 小结

* 汇编指令是机器指令的助记符，同机器指令一一对应；
* 每一种 CPU 都有自己的汇编指令集；
* CPU 可以直接使用的信息在存储器中存放；
* 在存储器中指令和数据没有任何区别，都是二进制信息。存储单元从零开始顺序编号。一个存储单元可以存储 8 个 bit， 即 8 位二进制数；
* 1 Byte = 8 bit；1 KB = 1024 B；1 MB = 1024 KB；1 GB = 1024 MB；
* 每一个 CPU 芯片都有许多管脚，这些管脚和总线相连。也可以说，这些管脚引出总线。一个 CPU 可以引出 3 种总线的宽度标志了这个 CPU 的不同方面的性能：

> * 地址总线的宽度决定了 CPU 的寻址能力；
> * 数据总线的宽度决定了 CPU 与其他器件进行数据传送时的一次数据传送量；
> * 控制总线的宽度决定了 CPU 对系统中其他器件的控制能力。
